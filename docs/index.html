<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    
    <style type="text/css">
      body {
  font-family: 'Avenir Next', 'Hiragino Kaku Gothic ProN', 'Meiryo', 'ãƒ¡ã‚¤ãƒªã‚ª', sans-serif;
  font-weight: bold;
}
h1, h2, h3 {
  font-weight: bold;
}
.remark-code,
.remark-inline-code {
  font-family: 'Menlo', 'Monaco', 'Courier new', monospace;
}

code.remark-code {
  display: block;
  padding: 0.7em;
  border-radius: 5px;
  background-color: #272822;
  color: #f3f3f3;
  font-size: 23px;
}

.remark-slide-content {
  color: #24292e;
  font-size: 32px;
  padding: 15px 60px;
}

.remark-slide-content.inverse {
  color: #f3f3f3;
  background-color: #272822;
}

.remark-slide-number a {
  color: #24292e;
  text-decoration: none;
}

.inverse .remark-slide-number a {
  color: #f3f3f3;
}

    </style>
  </head>
  <body>
    <textarea id="source">class: middle, center

# Deno ã§ Serverless

<img width="700" src="assets/img/banner.png" />

---
# [Issue 1456](https://github.com/denoland/deno/issues/1456)

<img width="800" src="assets/img/1456.png" />

---
class: middle, center
é«˜éœ€è¦
<img width="800" src="assets/img/1456b.png" />
---
class: middle, center
çµæ§‹å¤ã„ issue
<img width="800" src="assets/img/1456a.png" />

... ã ã‘ã©, ã¾ã  Open
---
class: middle, center
ğŸ¤”

Deno ã§ Serverless ã£ã¦å‡ºæ¥ã‚‹ã®?
---
è‡ªå·±ç´¹ä»‹ @kt3k

<img width="150" src="assets/img/hino-izu.jpg" style="border-radius: 50%;"/>

æ—¥é‡æ¾¤æ­“ä¹Ÿ (ã²ã®ã•ã‚ã‚ˆã—ã‚„)

- ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹ ã® ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ (React æ›¸ã„ã¦ã¾ã™)
- ä¸»ãªè·å ´ <img width="150" src="assets/img/r.png" /> & <img width="150" src="assets/img/s.png" />

---
class: middle, center
<img width="800" src="assets/img/custom-runtime.png" />
---
class: middle, center
ğŸ¤”

ä»Šã®Lambda ã¯ã©ã‚“ãªè¨€èªã§ã‚‚æ›¸ã‘ã‚‹ã“ã¨ã«ãªã£ã¦ã„ã‚‹ã‚‰ã—ã„
---
class: middle, center
[ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«](https://docs.aws.amazon.com/lambda/latest/dg/runtimes-walkthrough.html)ã‚’ã‚„ã£ã¦ã¿ãŸ
---
class: middle, center
<img width="800" src="assets/img/custom-runtime-sh.png" />

ã‚„ãŸã‚‰ã¨ã‚·ã‚§ãƒ«åŠ›ã®é«˜ã„[ã‚µãƒ³ãƒ—ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆ](https://gist.github.com/kt3k/17e29c36bd8743289afdf21049906ff4)
---
class: middle
è§£èª­ã—ã¦ã¿ã‚‹ã¨
- ãƒãƒ³ãƒ‰ãƒ© (lambda function) ã‚’åˆæœŸåŒ–ã—ã¦
- GET /runtime/invocation/next ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã£ã¦
- POST /runtime/invocation/:request_id/response ã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã›ã°è‰¯ã„ã£ã½ã„
---
class: middle, center
Deno ã§ã‚„ã£ã¦ã¿ã‚‹
---
```code
export DENO_DIR=/tmp/deno_dir
echo "
import { $HANDLER_NAME } from '$LAMBDA_TASK_ROOT/$HANDLER_FILE.ts';
const API_ROOT =
  'http://${AWS_LAMBDA_RUNTIME_API}/2018-06-01/runtime/invocation/';
(async () => {
  while (true) {
    const next = await fetch(API_ROOT + 'next');
    const reqId = next.headers.get('Lambda-Runtime-Aws-Request-Id');
    const res = await $HANDLER_NAME(await next.json());
    await (await fetch(
      API_ROOT + reqId + '/response',
      {
        method: 'POST',
        body: JSON.stringify(res)
      }
    )).blob();
  }
})();
" > /tmp/runtime.ts
$SCRIPT_DIR/deno run --allow-net --allow-read /tmp/runtime.ts
```
[link](https://github.com/kt3k/lambda-deno-runtime-wip/blob/master/bootstrap)
---
class: middle, center
ã¨ã‚Šã‚ãˆãš, ã“ã‚Œã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã¿ãŸã‚‰ç„¡äº‹å‹•ã„ãŸ! ğŸ’ª

<img width="700" src="assets/img/deno-lambda-success.png" />
---
ãƒãƒã£ãŸç‚¹
- ã‚«ã‚¹ã‚¿ãƒ ã® Deno ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚‹
  - [GLIBC 2.18 å•é¡Œ](https://github.com/denoland/deno/issues/1658)
- DENO_DIR ã‚’ /tmp/ ä»¥ä¸‹ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹
  - Lambda ç’°å¢ƒã§ã¯ /tmp/ ä»¥ä¸‹ã«ã—ã‹ Write å‡ºæ¥ãªã„
---
çµæ§‹è¨˜äº‹ã‚’æ›¸ã„ã¦æ¬²ã—ã„ã¨ã„ã†åå¿œãŒãƒ»ãƒ»ãƒ»
<img width="800" src="assets/img/reaction0.png" />
<img width="800" src="assets/img/reaction1.png" />
---
class: middle, center
[è¨˜äº‹åŒ–!](https://dev.to/kt3k/write-aws-lambda-function-in-deno-4b20)
<img width="700" src="assets/img/blog.png" />
---
class: middle, center
ãªã‹ãªã‹ã®åå¿œ

<img width="700" src="assets/img/reaction3.png" />
---
class: middle, center

æ°—ã¥ã„ãŸã‚‰å…¬å¼ã‚‚å‘Ÿã„ã¦ãã‚Œã¦ãŸ ğŸ˜º
<img width="700" src="assets/img/tweet-by-denoland.png" />
---
ãŸãã•ã‚“ã®æ®‹èª²é¡Œ
- GLIBC 2.18 å•é¡Œã®è§£æ±º
- Lambda Runtime ã® CI ã‚’ã™ã‚‹
  - AWS SAM ã¨ã„ã†ã®ä½¿ã†ã¨ã§ãã‚‹ã½ã„
- Cloud Function å¯¾å¿œ
- Azure Function å¯¾å¿œ
- Now 2 deno-builder ãŒä½œã‚Œãã†(?)
---
class: middle, center

Deno x Serverless ã‚„ã£ã¦ã„ãã! ğŸ’ª
---
class: middle, center

Fin ğŸ¦•
</textarea>
    <script src="remark.js"></script>
    
    <script>
      window.slideshow = remark.create({"slideNumberFormat":"#deno_ja #4 @kt3k - %current% / %total%"})
    </script>
    <script>
      
      ;window.LiveReloadOptions = {
        host: 'localhost',
        port: '35729'
      };
    </script>
  </body>
</html>
